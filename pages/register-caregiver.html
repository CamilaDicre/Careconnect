<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Careconnect - Caregiver Registration</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="../css/auth.css">
    .caregiver-container {
      max-width: 500px;
      margin: 48px auto 32px auto;
      background: rgba(255,255,255,0.97);
      border-radius: 32px;
      box-shadow: 0 8px 40px rgba(25,118,210,0.13);
      padding: 2.5rem 2rem 2rem 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
    }
    .caregiver-logo {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 1.2rem;
      animation: logoEntrance 1.1s cubic-bezier(0.23, 1, 0.32, 1);
      position: relative;
      z-index: 2;
    }
    .caregiver-logo::before {
      display: none;
    }
    .caregiver-logo img {
      width: 100px;
      height: 100px;
      border-radius: 0;
      background: transparent;
      margin-bottom: 0.3rem;
      position: relative;
      z-index: 2;
    }
    .caregiver-logo span {
      font-size: 2.3rem;
      font-weight: 800;
      color: #1565c0;
      letter-spacing: 2.5px;
      text-shadow: 0 2px 6px rgba(25,118,210,0.10), 0 1px 0 #fff;
      margin-top: 0.2rem;
      position: relative;
      z-index: 2;
    }
    @keyframes logoEntrance {
      0% { opacity: 0; transform: scale(0.7) translateY(40px) rotate(-8deg); filter: blur(2px); }
      60% { opacity: 1; transform: scale(1.08) translateY(-10px) rotate(2deg); filter: blur(0); }
      100% { opacity: 1; transform: scale(1) translateY(0) rotate(0deg); filter: blur(0); }
    }
    .caregiver-header {
      text-align: center;
      margin-bottom: 1.2rem;
    }
    .caregiver-header h1 {
      font-size: 1.7rem;
      color: #1976d2;
      margin: 0 0 0.5rem 0;
      font-weight: 700;
      letter-spacing: 1.5px;
    }
    .caregiver-header p {
      color: #1976d2;
      font-size: 1.08rem;
      margin-bottom: 0.5rem;
    }
    .caregiver-form {
      width: 100%;
      margin-top: 0.5rem;
    }
    .form-section {
      background: none;
      border-radius: 0;
      padding: 0 0 0.5rem 0;
      margin-bottom: 0.7rem;
      box-shadow: none;
      border: none;
    }
    .caregiver-form label {
      display: block;
      font-size: 1.18rem;
      font-weight: 700;
      color: #1565c0;
      margin-bottom: 0.18rem;
      margin-top: 1.1rem;
      letter-spacing: 0.7px;
      transition: color 0.2s;
      text-align: center;
    }
    .input-group {
      position: relative;
      margin-bottom: 1.1rem;
      background: #f6f8fc;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(25,118,210,0.07);
      display: flex;
      align-items: center;
      padding: 0.1rem 0.2rem 0.1rem 0.2rem;
    }
    .input-group i {
      position: absolute;
      left: 1.1rem;
      top: 50%;
      transform: translateY(-50%);
      color: #1976d2;
      font-size: 1.35rem;
      opacity: 0.95;
      pointer-events: none;
      transition: color 0.2s;
    }
    .caregiver-form input, .caregiver-form select, .caregiver-form textarea {
      width: 100%;
      font-size: 1.15rem;
      padding: 0.95rem 1.1rem 0.95rem 2.7rem;
      border-radius: 12px;
      border: none;
      background: transparent;
      margin-bottom: 0.1rem;
      margin-top: 0.1rem;
      box-sizing: border-box;
      transition: box-shadow 0.2s, background 0.2s;
      resize: none;
      outline: none;
      color: #222;
      font-weight: 500;
      text-align: center;
    }
    .caregiver-form input:focus, .caregiver-form select:focus, .caregiver-form textarea:focus {
      background: #e3eafc;
      box-shadow: 0 0 0 2px #1976d2;
    }
    .caregiver-form select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      background-image: url('data:image/svg+xml;utf8,<svg fill="%231976d2" height="20" viewBox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
      background-repeat: no-repeat;
      background-position: right 1.2rem center;
      background-size: 1.3rem;
      padding-right: 2.5rem;
    }
    .caregiver-form textarea {
      min-height: 90px;
      max-height: 220px;
    }
    .caregiver-main-btn {
      width: 100%;
      font-size: 1.18rem;
      font-weight: 700;
      border-radius: 14px;
      padding: 0.9rem 0;
      background: linear-gradient(90deg, #1976d2 60%, #63a4ff 100%);
      color: #fff;
      border: none;
      margin-top: 1.1rem;
      margin-bottom: 0.3rem;
      box-shadow: 0 2px 12px rgba(25, 118, 210, 0.13);
      transition: background 0.2s, box-shadow 0.2s;
      cursor: pointer;
    }
    .caregiver-main-btn:hover {
      background: linear-gradient(90deg, #1565c0 60%, #1976d2 100%);
    }
    @media (max-width: 600px) {
      .caregiver-container {
        padding: 1.2rem 0.2rem 1.2rem 0.2rem;
        max-width: 98vw;
      }
      .form-section {
        padding: 0.7rem 0.2rem 0.5rem 0.2rem;
      }
    }
    .caregiver-form input[type="number"]::-webkit-inner-spin-button,
    .caregiver-form input[type="number"]::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    .caregiver-form input[type="number"] {
      -moz-appearance: textfield;
    }
    .caregiver-form input[type="date"] {
      /* Custom date text input styles */
      background: #f6f8fc;
      border-radius: 12px;
      border: none;
      box-shadow: 0 2px 8px rgba(25,118,210,0.07);
      padding: 0.95rem 1.1rem 0.95rem 2.7rem;
      font-size: 1.15rem;
      color: #222;
      font-weight: 500;
      text-align: center;
      transition: box-shadow 0.2s, background 0.2s;
      outline: none;
      margin-bottom: 0.1rem;
      margin-top: 0.1rem;
      letter-spacing: 1px;
    }
    .caregiver-form input#birthdate:focus {
      background: #e3eafc;
      box-shadow: 0 0 0 2px #1976d2;
    }
    .caregiver-form input#birthdate::placeholder {
      color: #b6c7e3;
      opacity: 1;
      text-align: center;
    }
    
    /* Estilos para los símbolos de género */
    #gender option[value="male"] {
      color: #1976d2;
      font-weight: 500;
    }
    #gender option[value="female"] {
      color: #e91e63;
      font-weight: 500;
    }
    #gender option[value=""] {
      color: #666;
    }
  </style>
</head>
<body>
  <a href="login.html#register" class="back-home-btn">
    <i class="bi bi-arrow-left"></i>
    <span>Back to register</span>
  </a>
  <div class="caregiver-container">
    <div class="caregiver-logo">
      <div style="display:flex; align-items:center; justify-content:center; gap:2px;">
        <img src="assets/Frame - 1.svg" alt="Careconnect Logo" style="width: 100px; height: 100px; border-radius: 0; background: transparent;">
        <span style="font-family: 'Poppins', Arial, sans-serif; font-size: 2.3rem; font-weight: 700; color: #1565c0; letter-spacing: 2.5px; text-shadow: 0 2px 6px rgba(25,118,210,0.10), 0 1px 0 #fff;">areconnect</span>
      </div>
    </div>
    <div class="caregiver-header">
      <div style="font-size:1.08rem; color:#1976d2; margin-bottom:0.5rem; font-weight:500; letter-spacing:0.5px;">Please fill in your personal and professional information</div>
    </div>
    <form class="caregiver-form">
      <div class="form-section">
        <label for="fullName">Full Name</label>
        <div class="input-group">
          <i class="bi bi-person"></i>
          <input type="text" id="fullName" name="fullName" placeholder="Your full name" required>
        </div>
        <label for="email">Email</label>
        <div class="input-group">
          <i class="bi bi-envelope"></i>
          <input type="email" id="email" name="email" placeholder="Your email" required>
        </div>
        <label for="password">Password</label>
        <div class="input-group">
          <i class="bi bi-lock"></i>
          <input type="password" id="password" name="password" placeholder="Create a password" required>
        </div>
        <label for="phone">Phone Number</label>
        <div class="input-group">
          <i class="bi bi-telephone"></i>
          <input type="tel" id="phone" name="phone" placeholder="Your phone number" required>
        </div>
        <label for="birthdate">Date of Birth</label>
        <div class="input-group">
          <i class="bi bi-calendar"></i>
          <input type="text" id="birthdate" name="birthdate" required placeholder="DD-MM-YYYY (e.g. 25-12-1970)" pattern="^(0[1-9]|[12][0-9]|3[01])-(0[1-9]|1[0-2])-(19|20)\d\d$" maxlength="10" autocomplete="off" inputmode="numeric">
        </div>
        <label for="gender">Gender</label>
        <div class="input-group">
          <i class="bi bi-gender-ambiguous"></i>
          <select id="gender" name="gender" required>
            <option value="">Select gender</option>
            <option value="female">♀ Female</option>
            <option value="male">♂ Male</option>
          </select>
        </div>
        <label for="address">Address</label>
        <div class="input-group">
          <i class="bi bi-geo-alt"></i>
          <input type="text" id="address" name="address" placeholder="Your address" required>
        </div>
      </div>
      <div class="form-section">
        <label for="experience">Experience (years)</label>
        <div class="input-group">
          <i class="bi bi-briefcase"></i>
          <input type="number" id="experience" name="experience" min="0" max="60" placeholder="Years of experience" required inputmode="numeric" style="text-align:center;">
        </div>
        <label for="education">Education</label>
        <div class="input-group">
          <i class="bi bi-mortarboard"></i>
          <input type="text" id="education" name="education" placeholder="Your education" required>
        </div>
        <label for="certifications">Certifications</label>
        <div class="input-group">
          <i class="bi bi-award"></i>
          <input type="text" id="certifications" name="certifications" placeholder="Any certifications (optional)">
        </div>
        <label for="skills">Skills</label>
        <div class="input-group">
          <i class="bi bi-stars"></i>
          <textarea id="skills" name="skills" placeholder="List your skills, separated by commas" required></textarea>
        </div>
        <label for="languages">Languages</label>
        <div class="input-group">
          <i class="bi bi-translate"></i>
          <input type="text" id="languages" name="languages" placeholder="Languages you speak" required>
        </div>
        <label for="bio">Short Bio</label>
        <div class="input-group">
          <i class="bi bi-chat-left-text"></i>
          <textarea id="bio" name="bio" placeholder="Tell us about yourself" required></textarea>
        </div>
        <label for="availability">Availability</label>
        <div class="input-group">
          <i class="bi bi-clock"></i>
          <select id="availability" name="availability" required>
            <option value="">Select availability</option>
            <option value="fulltime">Full-time</option>
            <option value="parttime">Part-time</option>
            <option value="weekends">Weekends</option>
            <option value="nights">Nights</option>
          </select>
        </div>
      </div>
      <button type="submit" class="caregiver-main-btn">Submit Profile</button>
    </form>
  </div>
  <script src="../js/localStorage-utils.js"></script>
  <script>
    document.querySelector('.caregiver-form').onsubmit = function(e) {
      e.preventDefault();
      
      // Obtener todos los campos requeridos
      const requiredFields = [
        'fullName', 'email', 'password', 'phone', 'birthdate', 'gender', 
        'address', 'experience', 'education', 'skills', 
        'languages', 'bio', 'availability'
      ];
      
      // Validar que todos los campos requeridos estén completos
      let isValid = true;
      requiredFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (!field.value.trim()) {
          isValid = false;
          field.style.borderColor = '#d32f2f';
          field.style.backgroundColor = '#ffebee';
        } else {
          field.style.borderColor = '';
          field.style.backgroundColor = '';
        }
      });
      
      if (!isValid) {
        alert('Please fill in all required fields.');
        return;
      }
      
      // Validaciones adicionales
      const fullName = document.getElementById('fullName').value.trim();
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const birthdate = document.getElementById('birthdate').value.trim();
      const bio = document.getElementById('bio').value.trim();
      const skills = document.getElementById('skills').value.trim();
      const address = document.getElementById('address').value.trim();
      
      // Validar longitud de campos
      if (fullName.length > 100) {
        alert('Full name is too long. Maximum 100 characters.');
        return;
      }
      
      if (email.length > 100) {
        alert('Email is too long. Maximum 100 characters.');
        return;
      }
      
      if (password.length < 6) {
        alert('Password must be at least 6 characters long.');
        return;
      }
      
      if (phone.length > 20) {
        alert('Phone number is too long. Maximum 20 characters.');
        return;
      }
      
      if (address.length > 200) {
        alert('Address is too long. Maximum 200 characters.');
        return;
      }
      
      if (bio.length > 500) {
        alert('Bio is too long. Maximum 500 characters.');
        return;
      }
      
      if (skills.length > 300) {
        alert('Skills list is too long. Maximum 300 characters.');
        return;
      }
      
      // Validar formato de email
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        alert('Please enter a valid email address.');
        return;
      }
      
      // Validar formato de fecha (más flexible)
      const dateRegex = /^(0?[1-9]|[12][0-9]|3[01])[\/\-\.](0?[1-9]|1[0-2])[\/\-\.](19|20)\d\d$/;
      if (!dateRegex.test(birthdate)) {
        alert('Please enter a valid date in format DD/MM/YYYY, DD-MM-YYYY, or DD.MM.YYYY');
        return;
      }
      
      // Verificar si localStorage está disponible
      if (!LocalStorageUtils.isAvailable()) {
        alert('localStorage is not available in your browser. Please enable it or try a different browser.');
        return;
      }
      
      // Mostrar estado de carga en el botón
      const submitBtn = this.querySelector('.caregiver-main-btn');
      const originalText = submitBtn.textContent;
      submitBtn.textContent = 'Submitting...';
      submitBtn.classList.add('loading');
      
      // Simular proceso de envío (1 segundo)
      setTimeout(() => {
        try {
          // Guardar datos en localStorage con sanitización
          const user = {
            username: LocalStorageUtils.sanitizeText(fullName),
            email: email.toLowerCase().trim(),
            password: password, // Guardar la contraseña como está
            phone: LocalStorageUtils.sanitizeText(phone),
            birthdate: LocalStorageUtils.normalizeDate(birthdate) || birthdate,
            gender: document.getElementById('gender').value,
            address: LocalStorageUtils.sanitizeText(address),
            experience: LocalStorageUtils.sanitizeText(document.getElementById('experience').value.trim()),
            education: LocalStorageUtils.sanitizeText(document.getElementById('education').value.trim()),
            certifications: LocalStorageUtils.sanitizeText(document.getElementById('certifications').value.trim()),
            skills: LocalStorageUtils.sanitizeText(skills),
            languages: LocalStorageUtils.sanitizeText(document.getElementById('languages').value.trim()),
            bio: LocalStorageUtils.sanitizeText(bio),
            availability: document.getElementById('availability').value,
            role: 'cuidador',
            registrationDate: new Date().toISOString(),
            id: Date.now().toString() + Math.random().toString(36).substr(2, 9)
          };
          
          // Obtener usuarios existentes
          let users = LocalStorageUtils.getItem('users', []);
          if (!Array.isArray(users)) {
            users = [];
          }
          
          // Evitar duplicados por email
          if (users.some(u => u.email === user.email)) {
            alert('Ya existe un usuario registrado con este email.');
            submitBtn.textContent = originalText;
            submitBtn.classList.remove('loading');
            return;
          }
          
          // Agregar nuevo usuario
          users.push(user);
          
          // Guardar usuarios actualizados
          if (!LocalStorageUtils.setItem('users', users, 5000000)) { // 5MB límite
            alert('Error al guardar los datos. Por favor, verifica que tienes suficiente espacio de almacenamiento.');
            submitBtn.textContent = originalText;
            submitBtn.classList.remove('loading');
            return;
          }
          
          // Guardar datos de sesión
          LocalStorageUtils.setItem('loggedInUser', user.username);
          LocalStorageUtils.setItem('userRole', user.role);
          LocalStorageUtils.setItem('currentUserId', user.id);
          
          // Mostrar mensaje de éxito
          alert('¡Registro exitoso! Redirigiendo al dashboard...');
          
          // Redirigir al dashboard de cuidadores
          window.location.href = '../dashboard/caregivers pro/Caregiver-pro.html';
          
        } catch (error) {
          console.error('Error during registration:', error);
          alert('Error durante el registro. Por favor, intenta de nuevo.');
          submitBtn.textContent = originalText;
          submitBtn.classList.remove('loading');
        }
      }, 1000);
    };
  </script>
</body>
</html> 